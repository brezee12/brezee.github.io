(function(){var u,v,c,y,p,w,b,k,d,g,f;try{var i=Microsoft.Maps,n=i.Internal,st=n.__assign,ht=n.__extends,ct=n.__spreadArray,s=i.globalConfig,lt=n.coreConfig,t=s.features,at=t.advertising,vt=t.autosuggest,yt=t.calendar,pt=t.collections,wt=t.directions,bt=t.feedback,kt=t.flyover,dt=t.landmarks3D,gt=t.map3D,ni=t.richMapsInfobox,ti=t.labels,tt=t.layerManager,ii=t.localGuide,ri=t.localSearch,ui=t.mapBuilder,fi=t.mapDelay,ei=t.optIn,it=t.print,l=t.sharing,rt=t.streetside,oi=t.taskBar,a=t.taskFramework,si=t.trafficControl,hi=t.traffic,ci=t.trafficExperiences,li=t.mapBuilderExperiences,ai=t.transit,vi=t.travel,yi=t.xsr,pi=atlas.math,wi=atlas.data,bi=atlas.layer,ki=atlas.Pixel,di=atlas.data.BoundingBox,gi=n.AzureMapEvents,nr=n.AzureMapInteractions,tr=n.Binding,ir=n.BoundsAccumulator,rr=n.Debug,r=n.Gimme,ut=n.AtlasHelper,ur=n.EntityHelper,e=n.Helper,fr=n.LocationRectHelper,er=n.LocalStorageCache,or=n.LruCache,ft=n.MapMath,sr=n.Network,hr=n.JSEvent,cr=n.ObjectWithId,lr=n.Observable,ar=n.ObservableCollection,vr=n.ObservableObject,yr=n.Overlay,pr=n.PyramidTileSpatialIndex,wr=n.TaskDataHandlerHelper,br=n.TileSystemHelper,kr=n.PerfV2Logger,dr=n.VectorMath,gr=n.TimeoutWrapper,nu=i.Anchor,tu=i.BingMapStyle,iu=i.Color,ru=i.globalContainer,et=n.InstrumentationBase,uu=i.LatLonCrs,h=i.Location,fu=n.ObservableObjectChangedArgs,eu=i.Point,ou=i.Rectangle,su=i.ResourceManager,hu=i.SimpleAreaPrimitive,cu=i.SimpleLinePrimitive,lu=i.SimplePointPrimitive,au=i.Size,vu=n.Control,ot=n.ControlTemplate,o=i.GlobalDataEventHandler,yu=i.TaskManager;(function(n){function i(n,i,r){if(n)try{if(!n.isEnabled||t[r])return}catch(u){return}o.registerDataHandler(i,r);o.registerEventForDataAttribute("click",i,{preventDefault:!0});t[r]=!0}var t={};n.register=i})(u||(u={}));v=function(){function n(){}return n.prototype.processData=function(n,t,r){var e,f,u;if(s.enableInstrumentation)if(e=i.logger,n==="data-instrumentation"){if(!(t&&(t.logData||t.flush)))throw new Error("Invalid options passed");if(f=null,u=r,t.logData){if(!t.impressionGuid)while(u&&u.length&&u.get_attr){if(f=u.get_attr("data-ig"),f)break;u=u.getParent()}e.logObject(t.logData,f||t.impressionGuid,t.isMapsAction)}t.flush&&e.flush()}else n==="data-serverInstrumentation"&&et.SendInstrumentationToServer(t.logData.data,t.logData.feature)},n}();c="InstrumentationDataHandler";u.register(null,"data-instrumentation",c);u.register(null,"data-serverInstrumentation",c);y=function(){function n(n){this._container=n}return n.prototype.processData=function(n,t){t&&this._activateLayerManager(t)},n.prototype._activateLayerManager=function(t){this._container.instanceAsync("LayerManagerModule",function(i){if(n._isCategoryEnabled(t)||t.action==="activateNearbyLayer"||t.action==="removeNearbyLayer")switch(t.action){default:case"activateLayer":i.activate(t);break;case"removeLayer":i.remove(t.category,t.taskId);break;case"activateNearbyLayer":i.activateNearbyLayer(t.category,t.url);break;case"removeNearbyLayer":i.removeNearbyLayer(t.category);break;case"updateDisplayState":i.updateDisplayState(t.category,t.taskId,t.displayState);break;case"updateFilters":i.updateFilters(t.category,t.taskId,t.filters);break;case"updateQuery":i.updateQuery(t.category,t.taskId,t.queryText);break;case"updateRoutePoints":i.updateRoutePoints(t.category,t.taskId,t.routePoints);break;case"updateTaskEntities":i.updateTaskEntities(t.category,t.taskId,t.taskEntities);break;case"refreshData":i.refreshData(t.category,t.taskId);break;case"removeAllLayers":i.removeAll()}})},n._isCategoryEnabled=function(n){for(var u,i=n.category,f=s.features.layerManager,r=f.enabledCategories,t=0,o=r.length;t<o;t++)if(u=r[t],i===u)return!0;return e._isHotelsCategory(i)?(n.category="hotel",!0):!1},n}();u.register(tt,"data-managelayer","LayerManagerDataHandler");p=function(){function n(n,t){this._taskManager=n;this._layoutManager=t}return n.prototype.processData=function(n,t){if(t)switch(t.action){default:case"changeLayout":t.name&&this._layoutManager.activateLayout(t.name);break;case"updateLayout":t.state&&this._layoutManager.updateLayout(t.state)}else throw new Error("Options is not passed");},n}();u.register(null,"data-layout","LayoutDataHandler");w=function(){function n(n){this._printManager=n}return n.prototype.processData=function(n,t){n==="data-print"&&t&&t.source&&this._printManager.showPrintDialog(t)},n}();u.register(it,"data-print","PrintDataHandler");b=function(){function n(n,t){this._map=n;this._taskBar=t}return n.prototype.processData=function(n,t){var i=t||{action:"share"};i.entryPoint=i.entryPoint||"";this.currentSharingOptions={entryPoint:i.entryPoint};switch(i.action){case"shareTasks":this.currentSharingOptions.taskIds=i.taskIds||[];default:case"share":this._showSharingUX(i);break;case"closeShare":this._closeSharingUX(i)}},n.prototype._showSharingUX=function(){var n=this._map,s=n.getContainer(),t,u;if(l.enableMultipleCardSharing)if(this._taskBar&&this._taskBar.setActionsState(8,2),r(".taskBar").set_style({"z-index":"998"}),t=e._createElement("div"),t.set_attr("class","bm_allButTaskFrameworkLane"),r("#container").append(t),r(".".concat("taskLayoutContainer")).add_class("select"),u=n.getStyle(),u==="streetside"){this.currentSharingOptions.taskIds=null;this._pseudoShareDialog=ot.createControl("SharePanel");this._pseudoShareDialog.setInitialData({container:s});var i=e._createElement("div"),h=n.getRootElement(),f="bm_l2NavLeft bm_pseudoShareDialog bm_tcfDesign_A";a.newCardSizingForTCF&&(f+=" bm_phase2");i.set_attr("class",f);h.append(i);i.append(this._pseudoShareDialog.getRootElement());this._pseudoShareDialog.refresh(!0)}else o.invokeHandler("data-layout",{action:"changeLayout",name:"MultiCardLeftSelectionLayout"}),r("#sb_feedback").set_style({display:"none"})},n.prototype._closeSharingUX=function(){this._pseudoShareDialog?(this._pseudoShareDialog.dispose(),this._pseudoShareDialog=null,r("#mapContainer").set_style({"min-height":""})):o.invokeHandler("data-layout",{action:"changeLayout",name:"MultiCardLeftLayout"});r("#sb_feedback").set_style({display:"inline"});r(".".concat("taskLayoutContainer")).remove_class("select");this._taskBar&&this._taskBar.setActionsState(8,1);r(".taskBar").set_style({"z-index":""});r(".NavBar_Container").set_style({"z-index":"1005"});r(".bm_allButTaskFrameworkLane").removeFromParent();r(".bm_pseudoShareDialog").removeFromParent()},n}();u.register(l,"data-share","ShareDataHandler");k=function(){function n(n){this._map=n;this._disposables={}}return n.prototype.processData=function(n,t){if(t&&t.action){!t.location||t.location instanceof h||(t.location=new h(t.location.latitude,t.location.longitude,t.location.altitude,t.location.altitudeReference));switch(t.action){case"toggleCoverageMap":this._toggleCoverageMap(t.map);break;case"showDirectionsBubbleOverlay":this._showDirectionsBubbleOverlay(t);break;case"showBubbleImage":this._showStreetsideBubbleImage(t);break;case"showBubble":this._showStreetsideBubble(t);break;case"dispose":this._disposeResources(t);break;default:console.error("Invalid action")}}else console.error("Invalid options passed")},n.prototype._toggleCoverageMap=function(){console.error("to be impelmented: _toggleCoverageMap")},n.prototype._showDirectionsBubbleOverlay=function(){console.error("to be impelmented: _showDirectionsBubbleOverlay")},n.prototype._showStreetsideBubble=function(n){var t,i=function(){var t;(t=n.errorCallback)===null||t===void 0?void 0:t.call(n)};n.location?this._activateStreetsideMode(n.location,(t=n.localDetailsStartupOptions)===null||t===void 0?void 0:t.heading):i()},n.prototype._showStreetsideBubbleImage=function(n){var t=this,r=n.localDetailsStartupOptions,o=function(){n.errorCallback&&n.errorCallback()};if(n.location&&r&&r.sivImageContainer.length>0){var u=r.sivImageContainer,f=n.localDetailsStartupOptions.routablePoint,e=h.cloneFrom(f||n.location),s=f&&n.location?ft.getAngleBetweenTwoLocations(f,n.location):0;this._map.getAzureMap().mapLoaded.then(function(){t._map.getContainer().downloadDependencyAsync("Streetside",function(){var r=new i.StreetsideControl(t._map,null,{rootElement:u[0],disableBubbleNavigation:!0,overviewMapMode:"hidden",showAttribution:!1,showCloseButton:!1,showCurrentAddress:!1,showHeadingCompass:!1,showProblemReporting:!1,showZoomButtons:!1,setFocusOnLoad:!1});t._disposables[n.id]=[r];r.isStreetsideAvailable({center:e.getPosition(),heading:s}).then(function(i){i?(u.set_style({display:"block","z-index":0}),u.add_event("click",function(n){n.preventDefault();t._activateStreetsideMode(e)}),r.activate({center:e.getPosition()}).then(function(){n.callback&&n.callback()})):o()})})})}else o()},n.prototype._activateStreetsideMode=function(n,t){this._map.getStreetsideControl().then(function(i){i.activate({center:[n.longitude,n.latitude],heading:t})})},n.prototype._disposeResources=function(n){ut._clearDisposables(this._disposables[n.id])},n._streetsideCoverageBehaviorClassName="StreetsideCoverageBehavior",n}();u.register(rt,"data-streetside","StreetsideDataHandler");d=function(){function n(n,t){this._container=n;this._taskManager=t}return n.prototype.processData=function(n,t,i){var s=this,r,u,f,o;if(t){r=!1;switch(t.action){default:case"activate":t.type&&(u=e._overrideTasktypeBasedOnCategory(t.type,t.state,i),f=u?u:t.type,this._container.instanceAsync(f,function(n){s._taskManager.activateTask(n,t.state,t.activateOptions)}),r=!0);break;case"activateHidden":t.id&&(o=this._taskManager.getHiddenTaskById(t.id),this._taskManager.activateTask(o,t.state,t.activateOptions,!0),r=!0);break;case"focus":t.id&&(this._taskManager.focusTask(t.id,t.state),r=!0);break;case"remove":t.id&&(this._taskManager.removeTask(t.id),r=!0);break;case"removeTaskOrStackIfNotForeground":t.id&&(this._taskManager.removeTaskOrStackIfNotForeground(t.id),r=!0);break;case"removeStack":t.id&&(this._taskManager.removeTaskStack(t.id),r=!0);break;case"removeStackForTask":t.id&&(this._taskManager.removeStackForTask(t.id),r=!0);break;case"removeTaskAndReseatChild":t.id&&(this._taskManager.removeTaskAndReseatChild(t.id),r=!0);break;case"removeAllStacks":this._taskManager.removeAllStacks(t.clearHistoryState);this._taskManager.removeHiddenTasks();r=!0}if(!r)throw new Error("Invalid options passed");}else throw new Error("Options is not passed");},n}();u.register(null,"data-task","TaskActivator");g=function(){function n(n,t){this._container=n;this._taskManager=t}return n.prototype.processData=function(n,t,i,r){var u=this;if(this._taskManager.isDeserializingTasks)this._taskManager.deserializationCompleted.addOne(function(){return u.processData(n,t,i,r)});else if(t&&t.type&&t.requestState)this.requestTaskProcess(t);else throw new Error("Invalid options passed");},n.prototype.requestTaskProcess=function(n){var e=this,t={requestorId:n.requestorId,requestorState:n.requestorState,requestState:n.requestState},i,r,f,o,u,s;if(n.taskId)this._processSpecificTask(n.taskId,t,n);else if(n.useActiveTasks)if(i=this._taskManager.getTaskByType(n.type),r=[],i&&i.length>0)for(f=0,o=function(u){var o=i[u];if(!o.process)throw new Error("Process is not implemented by task: "+n.type);o.process(t,function(u){u.processorId=o.id;r.push(u);f++;f===i.length&&e._invokeRequestorTask(n,t,r)})},u=0;u<i.length;u++)o(u);else this._invokeRequestorTask(n,t,r);else s=function(i){if(!i.process)throw new Error("Process is not implemented by task: "+n.type);i.process(t,function(i){e._invokeRequestorTask(n,t,[i])})},this._container.instanceAsync(n.type,s,null)},n.prototype._processSpecificTask=function(n,t,i){var u=this,r=this._taskManager.getTaskById(i.taskId);r&&r.process&&r.process(t,function(n){var f=[n];n.processorId=r.id;u._invokeRequestorTask(i,t,f)})},n.prototype._invokeRequestorTask=function(n,t,i){var r={processorType:n.type,inData:t,outData:i},u=n.requestorId&&this._taskManager.getTaskById(n.requestorId),f;!u&&i&&i.length&&i[0].originalProcessInputData&&(f=i[0].originalProcessInputData,u=f.requestorId&&this._taskManager.getTaskById(f.requestorId),u&&r.inData&&(r.inData.requestorId=f.requestorId,r.inData.requestorState=f.requestorState));u&&u.processCallback?u.processCallback(r):n.requestorType?this._container.instanceAsync(n.requestorType,function(n){n&&n.processCallback&&n.processCallback(r)}):n.processCallback&&n.processCallback(r)},n}();u.register(a,"data-process","TaskProcessDataHandler");f=n.DataHandlers={};f.InstrumentationDataHandler=v;f.LayerManagerDataHandler=y;f.LayoutDataHandler=p;f.PrintDataHandler=w;f.ShareDataHandler=b;f.StreetsideDataHandler=k;f.TaskActivator=d;f.TaskProcessDataHandler=g}catch(nt){if(i&&i.logger)i.logger.logCriticalError(nt);else throw nt;}}).call(window)